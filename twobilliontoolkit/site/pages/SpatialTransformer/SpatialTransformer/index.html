<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>SpatialTransformer - TwoBillionToolkit Documentation</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "SpatialTransformer";
        var mkdocs_page_input_path = "pages\\SpatialTransformer\\SpatialTransformer.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> TwoBillionToolkit Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">TwoBillionToolkit Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">TwobillionToolkit Pages</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" >SpatialTransformer</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../Database/">Database</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Datatracker/">Datatracker</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Parameters/">Parameters</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Processor/">Processor</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">SpatialTransformer</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#twobilliontoolkit.SpatialTransformer.spatial_transformer">spatial_transformer</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#twobilliontoolkit.SpatialTransformer.spatial_transformer.main">main</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#twobilliontoolkit.SpatialTransformer.spatial_transformer.spatial_transformer">spatial_transformer</a>
    </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../GeoAttachmentSeeker/">GeoAttachmentSeeker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Logger/">Logger</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../NetworkTransfer/">NetworkTransfer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../RecordReviser/">RecordReviser</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../RippleUnzipple/">RippleUnzipple</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">TwoBillionToolkit Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">TwobillionToolkit Pages</li>
          <li class="breadcrumb-item">SpatialTransformer</li>
      <li class="breadcrumb-item active">SpatialTransformer</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="spatialtransformer">SpatialTransformer</h1>


<div class="doc doc-object doc-module">



<a id="twobilliontoolkit.SpatialTransformer.spatial_transformer"></a>
    <div class="doc doc-contents first">

      <p>File: twobilliontoolkit/SpatialTransformer/spatial_transformer.py
Created By:       Anthony Rodway
Email:            anthony.rodway@nrcan-rncan.gc.ca
Creation Date:    Wed November 15 10:30:00 PST 2023
Organization:     Natural Resources of Canada
Team:             Carbon Accounting Team</p>


<details class="description" open>
  <summary>Description</summary>
  <p>The spatial_transformer.py script is a Python tool for processing spatial data. It handles tasks like geodatabase creation, file validation, and checking project numbers against a master data sheet. </p>
</details>

<details class="usage" open>
  <summary>Usage</summary>
  <p>python path/to/spatial_transformer.py [-h] --input_path input_path [--output_path output_path] --gdb_path gdb_path --master master_data_path --load {datatracker,database} --save {datatracker,database} [--datatracker datatracker_path] [--attachments attachments_path] [--debug][--suppress] [--resume]</p>
</details>


  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="twobilliontoolkit.SpatialTransformer.spatial_transformer.main" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">main</span><span class="p">()</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>The main function of the spatial_transformer.py script</p>

            <details class="quote">
              <summary>Source code in <code>twobilliontoolkit\SpatialTransformer\spatial_transformer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; The main function of the spatial_transformer.py script &quot;&quot;&quot;</span>
    <span class="c1"># Get the start time of the script</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">Colors</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Tool is starting... Time: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Initialize the argument parse</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Spatial Transformer Tool&#39;</span><span class="p">)</span>

    <span class="c1"># Define command-line arguments</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--input_path&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Directory or Compressed file location that will be handed to Ripple Unzipple&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--output_path&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Where the final output of Ripple Unzipple will extract to.&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--load&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;datatracker&#39;</span><span class="p">,</span> <span class="s1">&#39;database&#39;</span><span class="p">],</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;database&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Specify what to load from (datatracker or database)&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--save&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;datatracker&#39;</span><span class="p">,</span> <span class="s1">&#39;database&#39;</span><span class="p">],</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;database&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Specify what to save to (datatracker or database)&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--gdb_path&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path of where the geodatabase will be saved, if it does not already exist, it will be created.&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--datatracker&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name of the datatracker file that will be saved adjacent to the geodatabase if provided&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--attachments&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Name of the attachments folder that will be saved adjacent to the geodatabase&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--master&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;The location of the master aspatial datasheet&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--debug&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Enable debug mode&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--resume&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Resume from where a crash happened&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--suppress&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Suppress Warnings in the command-line and only show Errors&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ps_script&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;The location of the script to run commands if used.&#39;</span><span class="p">)</span>

    <span class="c1"># Parse the command-line arguments</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="c1"># Call the entry function</span>
    <span class="n">spatial_transformer</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">input_path</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">output_path</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">load</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">save</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">gdb_path</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">datatracker</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">attachments</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">master</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">resume</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">suppress</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">ps_script</span><span class="p">)</span>

    <span class="c1"># Get the end time of the script and calculate the elapsed time</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">log</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">Colors</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Tool has completed. Time: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">log</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">Colors</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Elapsed time: </span><span class="si">{</span><span class="n">end_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> seconds&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="twobilliontoolkit.SpatialTransformer.spatial_transformer.spatial_transformer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">spatial_transformer</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">load_from</span><span class="p">,</span> <span class="n">save_to</span><span class="p">,</span> <span class="n">gdb_path</span><span class="p">,</span> <span class="n">datatracker</span><span class="p">,</span> <span class="n">attachments</span><span class="p">,</span> <span class="n">master_data_path</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">resume</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ps_script</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>The spatial_transformer function serves as the main entry point for the spatial transformation script. Its primary purpose is to handle various tasks related to spatial data processing, such as starting the ripple_unzipple tool and geodatabase creation.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>input_path</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Path to the input directory or compressed file.</p>
              </div>
            </li>
            <li>
              <b><code>output_path</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Path to output data of Ripple Unzipple.</p>
              </div>
            </li>
            <li>
              <b><code>load_from</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Either 'database' or 'datatracker' to determine what to load the data from.</p>
              </div>
            </li>
            <li>
              <b><code>save_to</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Either 'database' or 'datatracker' to determine what to save the data to.</p>
              </div>
            </li>
            <li>
              <b><code>gdb_path</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Path to the Geodatabase.</p>
              </div>
            </li>
            <li>
              <b><code>datatracker</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Datatracker file name.</p>
              </div>
            </li>
            <li>
              <b><code>attachments</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Attachment folder name.</p>
              </div>
            </li>
            <li>
              <b><code>master_data_path</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>Path to the aspatial master data.</p>
              </div>
            </li>
            <li>
              <b><code>debug</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Determines if the program is in debug mode. Defaults False.</p>
              </div>
            </li>
            <li>
              <b><code>resume</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Determines if the program should resume from where a crash happened. Defaults False.</p>
              </div>
            </li>
            <li>
              <b><code>suppress</code></b>
                  (<code>bool</code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Determines if the program will suppress Warning Messages to the command line while running.</p>
              </div>
            </li>
            <li>
              <b><code>ps_script</code></b>
                  (<code>str</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The path location of the script to run spatial transformer.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>twobilliontoolkit\SpatialTransformer\spatial_transformer.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">spatial_transformer</span><span class="p">(</span><span class="n">input_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">output_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">load_from</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">save_to</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">gdb_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">datatracker</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">attachments</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">master_data_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">resume</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">suppress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">ps_script</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The spatial_transformer function serves as the main entry point for the spatial transformation script. Its primary purpose is to handle various tasks related to spatial data processing, such as starting the ripple_unzipple tool and geodatabase creation.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_path (str): Path to the input directory or compressed file.</span>
<span class="sd">        output_path (str): Path to output data of Ripple Unzipple.</span>
<span class="sd">        load_from (str): Either &#39;database&#39; or &#39;datatracker&#39; to determine what to load the data from.</span>
<span class="sd">        save_to (str): Either &#39;database&#39; or &#39;datatracker&#39; to determine what to save the data to.</span>
<span class="sd">        gdb_path (str): Path to the Geodatabase.</span>
<span class="sd">        datatracker (str): Datatracker file name.</span>
<span class="sd">        attachments (str): Attachment folder name.</span>
<span class="sd">        master_data_path (str): Path to the aspatial master data.</span>
<span class="sd">        debug (bool, optional): Determines if the program is in debug mode. Defaults False.</span>
<span class="sd">        resume (bool, optional): Determines if the program should resume from where a crash happened. Defaults False.</span>
<span class="sd">        suppress (bool, optional): Determines if the program will suppress Warning Messages to the command line while running.</span>
<span class="sd">        ps_script (str, optional): The path location of the script to run spatial transformer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create the logfile path</span>
    <span class="n">log_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">gdb_path</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.gdb&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_Log_</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">.txt&quot;</span><span class="p">)</span>

    <span class="c1"># Initialize a variable for the processor in case an error occurs beforehand</span>
    <span class="n">spatial_processor</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>       
        <span class="c1"># Initialize Parameters class</span>
        <span class="n">setup_parameters</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">,</span> <span class="n">gdb_path</span><span class="p">,</span> <span class="n">master_data_path</span><span class="p">,</span> <span class="n">datatracker</span><span class="p">,</span> <span class="n">attachments</span><span class="p">,</span> <span class="n">load_from</span><span class="p">,</span> <span class="n">save_to</span><span class="p">,</span> <span class="n">log_file</span><span class="p">,</span> <span class="n">debug</span><span class="p">,</span> <span class="n">resume</span><span class="p">,</span> <span class="n">suppress</span><span class="p">,</span> <span class="n">ps_script</span><span class="p">)</span>

        <span class="c1"># Start the unzip tool </span>
        <span class="n">setup_parameters</span><span class="o">.</span><span class="n">handle_unzip</span><span class="p">()</span>
        <span class="n">log</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">Colors</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Ripple Unzipple has completed extracted the files. Now starting to create the datatracker entries from the files. Time: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># Create the GDB</span>
        <span class="n">setup_parameters</span><span class="o">.</span><span class="n">create_gdb</span><span class="p">()</span>

        <span class="c1"># Initialize the SpatialData class</span>
        <span class="n">spatial_processor</span> <span class="o">=</span> <span class="n">Processor</span><span class="p">(</span><span class="n">setup_parameters</span><span class="p">)</span>

        <span class="c1"># Search for any spatial data and create an entry in the datatracker for each one</span>
        <span class="n">spatial_processor</span><span class="o">.</span><span class="n">create_datatracker_entries</span><span class="p">()</span>
        <span class="n">log</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">Colors</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;All entries have been created in the datatracker for the aspatial and spatial files. Now starting to process those found spatial files. Time: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># Go through the dictionary of entries and process them into the output geodatabase</span>
        <span class="n">spatial_processor</span><span class="o">.</span><span class="n">process_entries</span><span class="p">()</span>
        <span class="n">log</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">Colors</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;The Processor has completed processing the files into the Geodatabase. Now starting to extract attachments from the Geodatabase. Time: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># Extract attachments from the Geodatabase</span>
        <span class="n">spatial_processor</span><span class="o">.</span><span class="n">extract_attachments</span><span class="p">()</span>
        <span class="n">log</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">Colors</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;The Attachments Seeker has completed extracting the attachments from the geodatabase. Now starting to transfer over the files from the local directory to the specified output. Time: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># Move the local files to the specified output</span>
        <span class="n">success</span> <span class="o">=</span> <span class="n">transfer</span><span class="p">(</span>
            <span class="n">spatial_processor</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">local_dir</span><span class="p">,</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">spatial_processor</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">gdb_path</span><span class="p">),</span>
            <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">spatial_processor</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">gdb_path</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">spatial_processor</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">datatracker</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">spatial_processor</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">attachments</span><span class="p">),</span> <span class="n">spatial_processor</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">log</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_WARNING.txt&#39;</span><span class="p">,</span> <span class="n">spatial_processor</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">log</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_ERROR.txt&#39;</span><span class="p">],</span>
            <span class="n">spatial_processor</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">log</span>
        <span class="p">)</span>
        <span class="n">log</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">Colors</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;The Network Transfer has completed moving the files from local to the network. Now saving the data. Time: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># Save the data tracker before returning</span>
        <span class="n">spatial_processor</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="kc">True</span> <span class="k">if</span> <span class="n">resume</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">log</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">Colors</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;The changes have successfully been saved to the specified datatracker. Now opening Record Reviser. Time: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="c1"># Open the record reviser</span>
        <span class="nb">filter</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()}</span>
        <span class="n">call_record_reviser</span><span class="p">(</span><span class="n">spatial_processor</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">spatial_processor</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">gdb_path</span><span class="p">,</span> <span class="nb">filter</span><span class="p">)</span>
        <span class="n">log</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">Colors</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="s1">&#39;The Record Reviser has completed editing any entries and is closing.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">debug</span> <span class="ow">and</span> <span class="n">success</span><span class="p">:</span>
            <span class="c1"># Remove the local contents</span>
            <span class="n">spatial_processor</span><span class="o">.</span><span class="n">del_gdb</span><span class="p">()</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">setup_parameters</span><span class="o">.</span><span class="n">local_dir</span><span class="p">)</span>
            <span class="n">log</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">Colors</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Removing contents from the local directory completed. Time: </span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%H:%M:%S&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>        
        <span class="c1"># Log the error</span>
        <span class="n">log</span><span class="p">(</span><span class="n">log_file</span><span class="p">,</span> <span class="n">Colors</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span> <span class="n">ps_script</span><span class="o">=</span><span class="n">ps_script</span><span class="p">)</span>

        <span class="c1"># Save the data to the datatracker in case of crashing</span>
        <span class="k">if</span> <span class="n">spatial_processor</span><span class="p">:</span>
            <span class="n">spatial_processor</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">save_data</span><span class="p">(</span><span class="kc">True</span> <span class="k">if</span> <span class="n">resume</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">log</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">Colors</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="s1">&#39;A checkpoint has been made at the point of failure.&#39;</span><span class="p">)</span>

        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../Processor/" class="btn btn-neutral float-left" title="Processor"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../GeoAttachmentSeeker/" class="btn btn-neutral float-right" title="GeoAttachmentSeeker">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../Processor/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../GeoAttachmentSeeker/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
